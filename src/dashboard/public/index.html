<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sprint Runner â€” Dashboard</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Header -->
  <header id="header">
    <div class="header-left">
      <h1>ğŸƒ Sprint Runner</h1>
      <div class="sprint-nav">
        <button id="btn-prev" class="btn btn-nav" title="Previous sprint">â—€</button>
        <span id="sprint-label" class="sprint-badge">Sprint â€”</span>
        <button id="btn-next" class="btn btn-nav" title="Next sprint">â–¶</button>
      </div>
      <span id="phase-badge" class="phase-badge phase-init">init</span>
      <span id="viewing-indicator" class="viewing-indicator" style="display:none">ğŸ‘ viewing</span>
    </div>
    <div class="header-right">
      <span id="issue-count" class="issue-count">0/0 done</span>
      <span id="elapsed" class="elapsed">0m 00s</span>
      <select id="mode-toggle" class="mode-toggle" title="Execution mode">
        <option value="autonomous">ğŸ¤– Autonomous</option>
        <option value="hitl">ğŸ‘¤ Human-in-the-Loop</option>
      </select>
      <button id="btn-start" class="btn btn-primary" title="Start sprint">â–¶ Start</button>
      <button id="btn-pause" class="btn btn-warn" title="Pause sprint" style="display:none">â¸ Pause</button>
      <button id="btn-resume" class="btn btn-primary" title="Resume sprint" style="display:none">â–¶ Resume</button>
      <button id="btn-stop" class="btn btn-danger" title="Stop sprint" style="display:none">â¹ Stop</button>
      <button id="btn-chat" class="btn" title="Open Agent Chat">ğŸ’¬ Chat</button>
    </div>
  </header>

  <!-- Phase Stepper (sprint progress) -->
  <nav id="phase-stepper" class="phase-stepper">
    <span class="step" data-phase="refine">Refine</span>
    <span class="step-arrow">â†’</span>
    <span class="step" data-phase="plan">Plan</span>
    <span class="step-arrow">â†’</span>
    <span class="step" data-phase="execute">Execute</span>
    <span class="step-arrow">â†’</span>
    <span class="step" data-phase="review">Review</span>
    <span class="step-arrow">â†’</span>
    <span class="step" data-phase="retro">Retro</span>
    <span class="step-arrow">â†’</span>
    <span class="step" data-phase="complete">Done</span>
  </nav>

  <!-- Navigation Tabs -->
  <nav id="tab-nav" class="tab-nav">
    <button class="tab-btn tab-active" data-tab="sprint">ğŸƒ Sprint</button>
    <button class="tab-btn" data-tab="backlog">ğŸ“‹ Backlog</button>
    <button class="tab-btn" data-tab="blocked">ğŸš« Blocked</button>
    <button class="tab-btn" data-tab="decisions">âš–ï¸ Decisions <span id="decisions-badge" class="tab-badge" style="display:none">0</span></button>
    <button class="tab-btn" data-tab="ideas">ğŸ’¡ Ideas</button>
  </nav>

  <!-- Main content -->
  <main>
    <!-- Sprint Tab (default) -->
    <div id="tab-sprint" class="tab-content tab-visible">
      <!-- Left panel: Issues -->
      <section id="issues-panel" class="panel">
        <h2>Issues</h2>
        <ul id="issue-list"></ul>
      </section>

      <!-- Center panel: Activity + Log -->
      <section id="activity-panel" class="panel">
        <h2>Activity</h2>
        <ul id="activity-list"></ul>
        <h2>Log</h2>
        <div id="log-panel"></div>
      </section>
    </div>

    <!-- Backlog Tab -->
    <div id="tab-backlog" class="tab-content" style="display:none">
      <section class="panel panel-full">
        <div class="backlog-header">
          <h2>ğŸ“‹ Backlog</h2>
          <span id="backlog-count" class="badge">0 issues</span>
          <span id="sprint-capacity" class="capacity-badge"></span>
          <button id="btn-refresh-backlog" class="btn btn-small">ğŸ”„ Refresh</button>
        </div>
        <p class="tab-description">Refined issues ready for sprint planning. Click <strong>+ Sprint</strong> to add an issue to the current sprint.</p>
        <ul id="backlog-list" class="backlog-list"></ul>
        <div id="backlog-empty" class="empty-state" style="display:none">No refined issues in backlog. Refine ideas first.</div>
      </section>
    </div>

    <!-- Blocked Tab -->
    <div id="tab-blocked" class="tab-content" style="display:none">
      <section class="panel panel-full">
        <div class="backlog-header">
          <h2>ğŸš« Blocked Issues</h2>
          <span id="blocked-count" class="badge">0 blocked</span>
          <button id="btn-refresh-blocked" class="btn btn-small">ğŸ”„ Refresh</button>
        </div>
        <p class="tab-description">Issues blocked during execution. Add comments to provide guidance, then unblock to retry.</p>
        <ul id="blocked-list" class="backlog-list"></ul>
        <div id="blocked-empty" class="empty-state" style="display:none">No blocked issues. ğŸ‰</div>
      </section>
    </div>

    <!-- Decisions Tab -->
    <div id="tab-decisions" class="tab-content" style="display:none">
      <section class="panel panel-full">
        <div class="backlog-header">
          <h2>âš–ï¸ Human Decisions Needed</h2>
          <span id="decisions-count" class="badge">0 pending</span>
          <button id="btn-refresh-decisions" class="btn btn-small">ğŸ”„ Refresh</button>
        </div>
        <p class="tab-description">Issues requiring stakeholder input. Review each item and <strong>Approve</strong>, <strong>Reject</strong>, or <strong>Comment</strong>.</p>
        <ul id="decisions-list" class="backlog-list"></ul>
        <div id="decisions-empty" class="empty-state" style="display:none">No pending decisions. ğŸ‰</div>
      </section>
    </div>

    <!-- Ideas Tab -->
    <div id="tab-ideas" class="tab-content" style="display:none">
      <section class="panel panel-full">
        <div class="backlog-header">
          <h2>ğŸ’¡ Ideas</h2>
          <span id="ideas-count" class="badge">0 ideas</span>
          <button id="btn-refresh-ideas" class="btn btn-small">ğŸ”„ Refresh</button>
        </div>
        <p class="tab-description">Raw ideas awaiting refinement. Label issues with <code>type:idea</code> to see them here.</p>
        <ul id="ideas-list" class="backlog-list"></ul>
        <div id="ideas-empty" class="empty-state" style="display:none">No ideas found. Create issues with the <code>type:idea</code> label.</div>
      </section>
    </div>

    <!-- Session panel (always visible on right side) -->
    <section id="session-panel" class="panel session-panel">
      <div class="session-header">
        <h2>ACP Sessions</h2>
      </div>
      <ul id="session-list" class="session-list"></ul>
      <div id="session-viewer" class="session-viewer" style="display:none">
        <div class="session-viewer-header">
          <button id="btn-back-sessions" class="btn btn-small">â† Back</button>
          <span id="session-viewer-title"></span>
          <button id="btn-stop-session" class="btn btn-small btn-danger" title="Stop session">â¹ Stop</button>
        </div>
        <pre id="session-output" class="session-output"></pre>
        <div id="session-input-bar" class="session-input-bar">
          <input id="session-message-input" type="text" placeholder="Send message to sessionâ€¦" autocomplete="off" />
          <button id="btn-send-session" class="btn btn-small">Send</button>
        </div>
      </div>
    </section>

    <!-- Chat panel (slide-out) -->
    <section id="chat-panel" class="panel chat-panel" style="display:none">
      <div class="chat-header">
        <h2>Agent Chat</h2>
        <div class="chat-controls">
          <select id="chat-role">
            <option value="general">General</option>
            <option value="researcher">Researcher</option>
            <option value="planner">Planner</option>
            <option value="reviewer">Reviewer</option>
            <option value="refiner">Refiner</option>
          </select>
          <button id="btn-new-chat" class="btn btn-small">+ New</button>
          <button id="btn-close-chat" class="btn btn-small" title="Close panel">âœ•</button>
        </div>
      </div>
      <div id="chat-sessions-bar"></div>
      <div id="chat-messages"></div>
      <div class="chat-input-row">
        <textarea id="chat-input" placeholder="Type a messageâ€¦" rows="2"></textarea>
        <button id="btn-send" class="btn btn-primary btn-small" disabled>Send</button>
      </div>
    </section>
  </main>

  <!-- Connection status -->
  <footer>
    <span id="connection-status" class="status-dot status-disconnected"></span>
    <span id="connection-label">Disconnected</span>
  </footer>

  <script src="app.js"></script>
</body>
</html>
